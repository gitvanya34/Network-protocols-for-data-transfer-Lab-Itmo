# Лабораторная работа 4. TCP пакеты. 

## Задача: Обратиться к данным, начиная от номера регистра: №Студента*100
##### IP Адрес 109.167.241.225
#####  Порт TCP – 6340

* Сервер постоянно посылает TCP пакеты. 
* Пакеты зависят от времени. 
* Содержимое пакета – строки, которые начинается с: Student<#>. Дальнейшую информацию нужно расшифровать.
* Каждый студент читает эти пакеты по адресу 109.167.241.225 порт 6340.
* Студент анализирует строки, выбирает только те строки, которые касаются его номера и сохраняет 10 пакетов, а так же время, когда были собраны данные. 
* Работу необходимо выполнять в какой-либо среде программирования. 
* После этого студент формирует отчет, где подробно описывает свои действия.


#### Запускаем скрипт [lab4Tcp.ipynb](lab4Tcp.ipynb)

```python
!pip install PrettyTable

from datetime import datetime
import socket
import sys
from prettytable import PrettyTable
import time

def parsePacket(packet, student):
  s = str(packet).find(student)
  if(s == -1): return f"\'{student}\' Not in the package"
  return str(packet)[s:s+42]

ip = '109.167.241.225'
port = 6340

conn = socket.socket()
conn.connect((ip, port))
conn.send(b"")

th = ['DateTime','IP Address','Port','Packet№','Student№', 'ResponsePacketForStudent']
td = []

columns = len(th) 
table = PrettyTable(th)

print(conn.recv(1024))
print(f"Full packet: [{conn.recv(1024)}]")
for i in range(0,10):
    table.add_row([datetime.now(),ip,port,i,3, parsePacket(conn.recv(1024),'Student 3') ])
    time.sleep(0.2)
    

print(table)
conn.close()
```

```log
b'\x00\x00\x043'
Full packet: [b'Student 1 2023-02-24-21-30-47,216 0,777222 Student 2 2023-02-24-21-30-47,216 0,002845 Student 3 2023-02-24-21-30-47,216 0,308951 Student 4 2023-02-24-21-30-47,216 0,613347 Student 5 2023-02-24-21-30-47,216 0,575663 Student 6 2023-02-24-21-30-47,216 0,033731 Student 7 2023-02-24-21-30-47,216 0,573050 Student 8 2023-02-24-21-30-47,216 0,317914 Student 9 2023-02-24-21-30-47,216 0,132515 Student10 2023-02-24-21-30-47,216 0,963488 Student11 2023-02-24-21-30-47,216 0,323945 Student12 2023-02-24-21-30-47,216 0,210475 Student13 2023-02-24-21-30-47,216 0,857535 Student14 2023-02-24-21-30-47,216 0,215444 Student15 2023-02-24-21-30-47,216 0,944103 Student16 2023-02-24-21-30-47,216 0,280411 Student17 2023-02-24-21-30-47,216 0,319365 Student18 2023-02-24-21-30-47,216 0,156366 Student19 2023-02-24-21-30-47,216 0,333273 Student20 2023-02-24-21-30-47,216 0,033218 Student21 2023-02-24-21-30-47,216 0,171654 Student22 2023-02-24-21-30-47,216 0,706099 Student23 2023-02-24-21-30-47,216 0,077029 Student24 2023-02-24-21-30-47,216 0']
+----------------------------+-----------------+------+---------+----------+--------------------------------------------+
|          DateTime          |    IP Address   | Port | Packet№ | Student№ |          ResponsePacketForStudent          |
+----------------------------+-----------------+------+---------+----------+--------------------------------------------+
| 2023-02-24 18:30:48.378525 | 109.167.241.225 | 6340 |    0    |    3     | Student 3 2023-02-24-21-30-47,316 0,480443 |
| 2023-02-24 18:30:48.578894 | 109.167.241.225 | 6340 |    1    |    3     | Student 3 2023-02-24-21-30-47,416 0,733832 |
| 2023-02-24 18:30:48.779254 | 109.167.241.225 | 6340 |    2    |    3     | Student 3 2023-02-24-21-30-47,517 0,531523 |
| 2023-02-24 18:30:48.979603 | 109.167.241.225 | 6340 |    3    |    3     | Student 3 2023-02-24-21-30-47,616 0,057157 |
| 2023-02-24 18:30:49.179978 | 109.167.241.225 | 6340 |    4    |    3     | Student 3 2023-02-24-21-30-47,718 0,894633 |
| 2023-02-24 18:30:49.380356 | 109.167.241.225 | 6340 |    5    |    3     | Student 3 2023-02-24-21-30-47,818 0,789615 |
| 2023-02-24 18:30:49.580697 | 109.167.241.225 | 6340 |    6    |    3     | Student 3 2023-02-24-21-30-47,920 0,484580 |
| 2023-02-24 18:30:49.781130 | 109.167.241.225 | 6340 |    7    |    3     | Student 3 2023-02-24-21-30-48,020 0,121080 |
| 2023-02-24 18:30:49.981546 | 109.167.241.225 | 6340 |    8    |    3     | Student 3 2023-02-24-21-30-48,121 0,839947 |
| 2023-02-24 18:30:50.181887 | 109.167.241.225 | 6340 |    9    |    3     | Student 3 2023-02-24-21-30-48,221 0,876347 |
+----------------------------+-----------------+------+---------+----------+--------------------------------------------+
```
 